-- Импорт данных из файла "Номерной фонд.xlsx"
USE HotelDB;

-- Очистка таблицы типов номеров перед импортом (если требуется)
-- DELETE FROM RoomTypes;

-- Вставка типов номеров (на основе информации из "Номерной фонд.xlsx")
INSERT INTO RoomTypes (TypeName, Description, BasePrice) VALUES
('Стандарт одноместный', 'Стандартный номер с односпальной кроватью', 2500.00),
('Стандарт двухместный', 'Стандартный номер с двуспальной кроватью', 3500.00),
('Люкс', 'Номер повышенной комфортности с гостиной и спальней', 6000.00),
('Полулюкс', 'Улучшенный номер с двуспальной кроватью и диваном', 4500.00),
('Семейный', 'Номер с двумя спальнями и общей гостиной', 5500.00);

-- Очистка таблицы номеров перед импортом (если требуется)
-- DELETE FROM Rooms;

-- Вставка номеров (на основе информации из "Номерной фонд.xlsx")
INSERT INTO Rooms (RoomNumber, RoomTypeID, Floor, Capacity, StatusID, Description) VALUES
('101', 1, 1, 1, 1, 'Стандартный одноместный номер с видом на парк'),
('102', 2, 1, 2, 1, 'Стандартный двухместный номер с видом на улицу'),
('103', 2, 1, 2, 1, 'Стандартный двухместный номер с видом на парк'),
('104', 1, 1, 1, 1, 'Стандартный одноместный номер с видом на улицу'),
('105', 4, 1, 3, 1, 'Полулюкс с видом на парк'),
('201', 2, 2, 2, 1, 'Стандартный двухместный номер с балконом'),
('202', 3, 2, 4, 1, 'Люкс с видом на город'),
('203', 5, 2, 5, 1, 'Семейный номер с террасой'),
('204', 2, 2, 2, 1, 'Стандартный двухместный номер с балконом'),
('205', 4, 2, 3, 1, 'Полулюкс с балконом и видом на парк'),
('301', 3, 3, 4, 1, 'Люкс с джакузи'),
('302', 1, 3, 1, 1, 'Стандартный одноместный номер с видом на город'),
('303', 4, 3, 3, 1, 'Полулюкс с сауной'),
('304', 2, 3, 2, 1, 'Стандартный двухместный номер с видом на город'),
('305', 5, 3, 5, 1, 'Семейный номер с кухней'),
('401', 3, 4, 4, 1, 'Пентхаус-люкс с террасой'),
('402', 3, 4, 4, 1, 'Пентхаус-люкс с панорамным видом');

-- Импорт данных из файла "Постояльцы живущие сейчас в гостинице.xlsx"

-- Вставка гостей (на основе информации из "Постояльцы живущие сейчас в гостинице.xlsx")
INSERT INTO Guests (FirstName, LastName, MiddleName, PassportNumber, PassportSeries, BirthDate, Phone, Email) VALUES
('Иван', 'Петров', 'Сергеевич', '123456', '7890', '1985-05-15', '+7(900)123-45-67', 'petrov@mail.ru'),
('Анна', 'Иванова', 'Владимировна', '234567', '8901', '1990-08-22', '+7(900)234-56-78', 'ivanova@gmail.com'),
('Сергей', 'Смирнов', 'Андреевич', '345678', '9012', '1978-11-10', '+7(900)345-67-89', 'smirnov@mail.ru'),
('Елена', 'Козлова', 'Михайловна', '456789', '0123', '1982-04-05', '+7(900)456-78-90', 'kozlova@gmail.com'),
('Алексей', 'Новиков', 'Дмитриевич', '567890', '1234', '1995-01-18', '+7(900)567-89-01', 'novikov@mail.ru');

-- Вставка бронирований и проживаний для текущих постояльцев
INSERT INTO Bookings (GuestID, RoomID, CheckInDate, CheckOutDate, BookingDate, AdultCount, ChildCount, TotalPrice, IsPaid, BookingStatusID, UserID) VALUES
(1, 2, '2023-03-10', '2023-03-20', '2023-03-01', 1, 0, 35000.00, 1, 1, 1),
(2, 6, '2023-03-12', '2023-03-22', '2023-03-05', 2, 0, 35000.00, 1, 1, 1),
(3, 11, '2023-03-15', '2023-03-25', '2023-03-10', 2, 2, 60000.00, 1, 1, 1),
(4, 13, '2023-03-18', '2023-03-23', '2023-03-15', 2, 1, 22500.00, 1, 1, 1),
(5, 16, '2023-03-20', '2023-03-30', '2023-03-18', 2, 0, 60000.00, 1, 1, 1);

-- Вставка данных о проживании
INSERT INTO Stays (BookingID, ActualCheckInDate, ActualCheckOutDate, CardKeyActivated, CardKeyDeactivationDate) VALUES
(1, '2023-03-10 14:00:00', NULL, 1, NULL),
(2, '2023-03-12 13:30:00', NULL, 1, NULL),
(3, '2023-03-15 15:15:00', NULL, 1, NULL),
(4, '2023-03-18 12:45:00', NULL, 1, NULL),
(5, '2023-03-20 16:00:00', NULL, 1, NULL);

-- Импорт данных из файла "Отчет по состоянию номерного фонда на дату.xlsx"

-- Обновление статусов номеров на основе данных из "Отчет по состоянию номерного фонда на дату.xlsx"
UPDATE Rooms SET StatusID = 2 WHERE RoomNumber IN ('102', '201', '301', '303', '401'); -- Установка статуса "Занят" для номеров с проживающими
UPDATE Rooms SET StatusID = 3 WHERE RoomNumber IN ('105', '204'); -- Установка статуса "Грязный" для номеров, требующих уборки
UPDATE Rooms SET StatusID = 4 WHERE RoomNumber IN ('305'); -- Установка статуса "Назначен к уборке" для номеров в графике уборки
UPDATE Rooms SET StatusID = 6 WHERE RoomNumber IN ('304'); -- Установка статуса "На ремонте" для номеров на обслуживании

-- Создание персонала для уборки
INSERT INTO CleaningStaff (UserID) VALUES (4); -- Предполагаем, что у нас есть пользователь с ID=4 и ролью "Уборщик"

-- Создание задач в графике уборки
INSERT INTO CleaningSchedule (RoomID, StaffID, ScheduledDate, CompletionDate, CleaningStatusID) VALUES
((SELECT RoomID FROM Rooms WHERE RoomNumber = '105'), 1, CURDATE(), NULL, 4),
((SELECT RoomID FROM Rooms WHERE RoomNumber = '204'), 1, CURDATE(), NULL, 4),
((SELECT RoomID FROM Rooms WHERE RoomNumber = '305'), 1, CURDATE(), NULL, 4); 